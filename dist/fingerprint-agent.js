(()=>{"use strict";var e=function(){return e=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},e.apply(this,arguments)};Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var t="Blocked by CSP",r="The endpoint parameter is not a valid URL";function n(e){for(var t="",r=0;r<e.length;++r)if(r>0){var n=e[r].toLowerCase();n!==e[r]?t+=" ".concat(n):t+=e[r]}else t+=e[r].toUpperCase();return t}var o=n("WrongRegion"),i=n("SubscriptionNotActive"),a=n("UnsupportedVersion"),u=n("InstallationMethodRestricted"),c=n("HostnameRestricted"),R=n("IntegrationFailed"),s=n("NetworkRestricted"),l=n("InvalidProxyIntegrationSecret"),f="API key required",E="API key not found",p="API key expired",d="Failed to load the JS script of the agent",O="9319";function _(e,n){var o,i,a,u,c,R=[],s=(o=function(e){var t=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}([],e,!0);return{current:function(){return t[0]},postpone:function(){var e=t.shift();void 0!==e&&t.push(e)},exclude:function(){t.shift()}}}(e),u=0,i=function(){return Math.random()*Math.min(3e3,100*Math.pow(2,u++))},a=new Set,[o.current(),function(e,n){var u,c=n instanceof Error?n.message:"";if(c===t||c===r)o.exclude(),u=0;else if(c===O)o.exclude();else if(c===d){var R=Date.now()-e.getTime()<50,s=o.current();s&&R&&!a.has(s)&&(a.add(s),u=0),o.postpone()}else o.postpone();var l=o.current();return void 0===l?void 0:[l,null!=u?u:e.getTime()+i()-Date.now()]}]),l=s[0],f=s[1];if(void 0===l)return Promise.reject(new TypeError("The list of script URL patterns is empty"));var E=function(e){var t=new Date,r=function(r){return R.push({url:e,startedAt:t,finishedAt:new Date,error:r})},o=n(e);return o.then((function(){return r()}),r),o.catch((function(e){if(null!=c||(c=e),R.length>=5)throw c;var r=f(t,e);if(!r)throw c;var n,o=r[0],i=r[1];return(n=i,new Promise((function(e){return setTimeout(e,n)}))).then((function(){return E(o)}))}))};return E(l).then((function(e){return[e,R]}))}var v="https://fpnpmcdn.net/v<version>/<apiKey>/loader_v<loaderVersion>.js";function I(e){return function(e,r){var n,o=document,i="securitypolicyviolation",a=function(t){var r=new URL(e,location.href),o=t.blockedURI;o!==r.href&&o!==r.protocol.slice(0,-1)&&o!==r.origin||(n=t,u())};o.addEventListener(i,a);var u=function(){return o.removeEventListener(i,a)};return Promise.resolve().then(r).then((function(e){return u(),e}),(function(e){return new Promise((function(e){var t=new MessageChannel;t.port1.onmessage=function(){return e()},t.port2.postMessage(null)})).then((function(){if(u(),n)return function(){throw new Error(t)}();throw e}))}))}(e,(function(){return function(e){return new Promise((function(t,n){if(function(e){if(URL.prototype)try{return new URL(e,location.href),!1}catch(e){if(e instanceof Error&&"TypeError"===e.name)return!0;throw e}}(e))throw new Error(r);var o=document.createElement("script"),i=function(){var e;return null===(e=o.parentNode)||void 0===e?void 0:e.removeChild(o)},a=document.head||document.getElementsByTagName("head")[0];o.onload=function(){i(),t()},o.onerror=function(){i(),n(new Error(d))},o.async=!0,o.src=e,a.appendChild(o)}))}(e)})).then(h)}function h(){var e=window,t="__fpjs_p_l_b",r=e[t];if(function(e,t){var r,n=null===(r=Object.getOwnPropertyDescriptor)||void 0===r?void 0:r.call(Object,e,t);(null==n?void 0:n.configurable)?delete e[t]:n&&!n.writable||(e[t]=void 0)}(e,t),"function"!=typeof(null==r?void 0:r.load))throw new Error(O);return r}var N={load:function(t){var r;t.scriptUrlPattern;var n=t.token,o=t.apiKey,i=void 0===o?n:o,a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(t,["scriptUrlPattern","token","apiKey"]),u=null!==(r=function(e,t){return function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(e,t)?e[t]:void 0}(t,"scriptUrlPattern"))&&void 0!==r?r:v,c=function(){var e=[],t=function(){e.push({time:new Date,state:document.visibilityState})},r=function(e,t,r,n){return e.addEventListener(t,r,n),function(){return e.removeEventListener(t,r,n)}}(document,"visibilitychange",t);return t(),[e,r]}(),R=c[0],s=c[1];return Promise.resolve().then((function(){if(!i||"string"!=typeof i)throw new Error(f);return _(function(e,t){return(Array.isArray(e)?e:[e]).map((function(e){return function(e,t){var r=encodeURIComponent;return e.replace(/<[^<>]+>/g,(function(e){return"<version>"===e?"3":"<apiKey>"===e?r(t):"<loaderVersion>"===e?r("3.11.10"):e}))}(String(e),t)}))}(u,i),I)})).catch((function(e){throw s(),function(e){return e instanceof Error&&e.message===O?new Error(d):e}(e)})).then((function(t){var r=t[0],n=t[1];return s(),r.load(e(e({},a),{ldi:{attempts:n,visibilityStates:R}}))}))},defaultScriptUrlPattern:v,ERROR_SCRIPT_LOAD_FAIL:d,ERROR_API_KEY_EXPIRED:p,ERROR_API_KEY_INVALID:E,ERROR_API_KEY_MISSING:f,ERROR_BAD_REQUEST_FORMAT:"Request cannot be parsed",ERROR_BAD_RESPONSE_FORMAT:"Response cannot be parsed",ERROR_CLIENT_TIMEOUT:"Client timeout",ERROR_CSP_BLOCK:t,ERROR_FORBIDDEN_ENDPOINT:c,ERROR_FORBIDDEN_HEADER:"Not available with restricted header",ERROR_FORBIDDEN_ORIGIN:"Not available for this origin",ERROR_GENERAL_SERVER_FAILURE:"Request failed",ERROR_INSTALLATION_METHOD_RESTRICTED:u,ERROR_INTEGRATION_FAILURE:R,ERROR_INVALID_ENDPOINT:r,ERROR_INVALID_PROXY_INTEGRATION_HEADERS:n("InvalidProxyIntegrationHeaders"),ERROR_INVALID_PROXY_INTEGRATION_SECRET:l,ERROR_NETWORK_ABORT:"Network request aborted",ERROR_NETWORK_CONNECTION:"Network connection error",ERROR_NETWORK_RESTRICTED:s,ERROR_RATE_LIMIT:"Too many requests, rate limit exceeded",ERROR_SERVER_TIMEOUT:"Request failed to process",ERROR_SUBSCRIPTION_NOT_ACTIVE:i,ERROR_TOKEN_EXPIRED:p,ERROR_TOKEN_INVALID:E,ERROR_TOKEN_MISSING:f,ERROR_UNSUPPORTED_VERSION:a,ERROR_WRONG_REGION:o,defaultEndpoint:{default:"endpoint"},defaultTlsEndpoint:{default:"tlsEndpoint"}};window.FingerprintJS=N})();